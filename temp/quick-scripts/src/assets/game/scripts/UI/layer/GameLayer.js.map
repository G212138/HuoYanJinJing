{"version":3,"sources":["assets\\game\\scripts\\UI\\layer\\GameLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { NetWork } from \"../../../../frame/scripts/Http/NetWork\";\r\nimport { ListenerManager } from \"../../../../frame/scripts/Manager/ListenerManager\";\r\nimport { SoundManager } from \"../../../../frame/scripts/Manager/SoundManager\";\r\nimport { SyncDataManager } from \"../../../../frame/scripts/Manager/SyncDataManager\";\r\nimport { T2M } from \"../../../../frame/scripts/SDK/T2M\";\r\nimport { HitTest } from \"../../../../frame/scripts/Utils/HitTest\";\r\nimport { MathUtils } from \"../../../../frame/scripts/Utils/MathUtils\";\r\nimport { Tools } from \"../../../../frame/scripts/Utils/Tools\";\r\nimport { UIHelp } from \"../../../../frame/scripts/Utils/UIHelp\";\r\nimport ButtonSync from \"../../Components/ButtonSync\";\r\nimport { CustomSyncData } from \"../../Data/CustomSyncData\";\r\nimport { EventType } from \"../../Data/EventType\";\r\nimport { EditorManager } from \"../../Manager/EditorManager\";\r\nimport { GameManager } from \"../../Manager/GameManager\";\r\nimport DanJun from \"../Item/DanJun\";\r\nimport GameItem from \"../Item/GameItem\";\r\nimport { SoundConfig } from \"../Item/SoundConfig\";\r\nimport JieMian1 from \"./JieMian1\";\r\nimport JieMian2 from \"./JieMian2\";\r\nimport JieMian3 from \"./JieMian3\";\r\n\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameLayer extends cc.Component {\r\n\r\n\r\n    @property(cc.Node)\r\n    private jieMian1: cc.Node = null;\r\n    @property(cc.Node)\r\n    private jieMian2: cc.Node = null;\r\n    @property(cc.Node)\r\n    private jieMian3: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private tiJiaoBtn: cc.Node = null;\r\n    @property(cc.Node)\r\n    private chongZhiBtn: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private maskNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    private overAinNode: cc.Node = null;\r\n\r\n\r\n    private get sysData() {\r\n        return SyncDataManager.getSyncData().customSyncData;\r\n    }\r\n\r\n    private set sysData(value) {\r\n        SyncDataManager.getSyncData().customSyncData = value;\r\n    }\r\n\r\n    private _isReconnect: boolean = false;\r\n    private _optionData: any = null;\r\n\r\n    //  375  260\r\n    onLoad() {\r\n    }\r\n\r\n    onDestroy() {\r\n    }\r\n\r\n\r\n    public _initData() {\r\n\r\n        this.maskNode.active = false;\r\n        this.overAinNode.active = false;\r\n\r\n        this.jieMian1.active = this.sysData.curLevel == 0;\r\n        this.jieMian2.active = this.sysData.curLevel == 1;\r\n        this.jieMian3.active = this.sysData.curLevel == 2;\r\n        this.tiJiaoBtn.active = this.sysData.curLevel != 2;\r\n        this.chongZhiBtn.active = this.sysData.curLevel == 2;\r\n\r\n        if (this.sysData.curLevel == 0 && !this._isReconnect) {\r\n            SoundManager.playEffect(\"bgm\", false, false, false);\r\n        }\r\n\r\n        if (this.sysData.curLevel == 0) {\r\n            this.jieMian1.getComponent(JieMian1).initData();\r\n        } else if (this.sysData.curLevel == 1) {\r\n            this.jieMian2.getComponent(JieMian2).initData();\r\n        } else {\r\n            this.jieMian3.getComponent(JieMian3).initData();\r\n        }\r\n    }\r\n\r\n    private clickTiJiao() {\r\n        this.tiJiaoBtn.children[0].active = false;\r\n        this.tiJiaoBtn.children[1].active = true;\r\n        SoundManager.playEffect(\"点击音效\", false, false, false);\r\n\r\n        this.sysData.curLevel++;\r\n        this._initData();\r\n    }\r\n\r\n    private clickChongZhi() {\r\n        this.tiJiaoBtn.children[0].active = false;\r\n        this.tiJiaoBtn.children[1].active = true;\r\n        SoundManager.playEffect(\"点击音效\", false, false, false);\r\n        SyncDataManager.getSyncData().customSyncData = new CustomSyncData();\r\n        this._initData();\r\n    }\r\n\r\n\r\n\r\n    // 正确错误反馈\r\n    private zhengQueCuoWuFanKui() {\r\n\r\n    }\r\n\r\n\r\n\r\n    private getcurGuanIsOver() {\r\n\r\n    }\r\n\r\n\r\n    private curGuanOver() {\r\n        this.maskNode.active = true;\r\n        this.sysData.isGameOver = true;\r\n        SyncDataManager.syncData.frameSyncData.isGameOver = true;\r\n        SyncDataManager.syncData.frameSyncData.showGameOver = true;\r\n        this.shangBaoZhengQueCuoWu(true);\r\n\r\n        this.overAinNode.active = true\r\n\r\n\r\n        this.scheduleOnce(() => {\r\n            this._gameOver()\r\n        }, 0.5)\r\n\r\n    }\r\n\r\n    /**\r\n    * @param isZhengQue 是否正确\r\n   */\r\n    private shangBaoZhengQueCuoWu(isZhengQue: boolean, isOver: boolean = true) {\r\n        if (isZhengQue) {\r\n            ListenerManager.dispatch(EventType.REPORT_RIGHT, isOver);\r\n        } else {\r\n            ListenerManager.dispatch(EventType.REPORT_WRONG, isOver);\r\n        }\r\n    }\r\n\r\n    // 下一题还是游戏结束\r\n    private _gameOver() {\r\n        // 游戏结束\r\n        ListenerManager.dispatch(EventType.GAME_OVER);\r\n    }\r\n\r\n    /**\r\n    * 绝对获取节点上的组件，如果不存在就添加一个\r\n    * @param node \r\n    * @param type \r\n    */\r\n    public getComponentAbsolutely<T extends cc.Component>(node: cc.Node, type: { prototype: T }) {\r\n        let comp = node.getComponent(type)\r\n        if (!comp) {\r\n            comp = node.addComponent(type as any)\r\n        }\r\n        return comp as T\r\n    }\r\n\r\n    // =====================================重连==========================================\r\n    public handleReconnect() {\r\n        UIHelp.closeMask();\r\n        cc.Tween.stopAll();\r\n        SoundManager.stopBGM();\r\n        SoundManager.stopAllEffect();\r\n        this.unscheduleAllCallbacks();\r\n        this._isReconnect = true;\r\n        this._initData();\r\n        this.scheduleOnce(() => {\r\n            this._isReconnect = false;\r\n        }, 0.5)\r\n    }\r\n\r\n}\r\n"]}